<!DOCTYPE html>
<!--
- Full screen clock (12-hour with seconds)
- Copyright (c) 2017 Project Nayuki
- 
- https://www.nayuki.io/page/full-screen-clock-javascript

- modified by Joseph Adams to include countdowns
-->
<html style="height:100%; margin:0; padding:0">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta http-equiv="refresh" content="30">
		<title>Clock</title>
		<style type="text/css">
			/* Customizable font and colors */
			html {
				background: #000000;
				font-family: sans-serif;
				font-weight: bold;
				color: #FFFFFF;
			}
		</style>
        <script type="text/javascript" src="countdowndata.js"></script>
	</head>
	
	<body style="height:100%; margin:0; padding:0; justify-content:center; align-items:center">
		<span id="clocktext" style="font-kerning:none"></span><br />
		<span id="countdown1text" style="font-kerning:none"></span><br />
        <span id="countdown1texttime" style="font-kerning:none"></span><br />
        <span id="countdown2text" style="font-kerning:none"></span><br />
        <span id="countdown2texttime" style="font-kerning:none"></span>
        <script type="text/javascript">
			
			var textElem = document.getElementById("clocktext");
			var textNode = document.createTextNode("");
			textElem.appendChild(textNode);
            
            var countdown1TextElem = document.getElementById("countdown1text");
            var countdown1TextTimeElem = document.getElementById("countdown1texttime");
    
            var countdown2TextElem = document.getElementById("countdown2text");
            var countdown2TextTimeElem = document.getElementById("countdown2texttime");
            
			var targetWidth = 0.9;  // Proportion of full screen width
			var curFontSize = 20;  // Do not change
			
			function updateClock() {
				var d = new Date();
				var s = "";
				s += ((d.getHours() + 11) % 12 + 1) + ":";
				s += (10 > d.getMinutes() ? "0" : "") + d.getMinutes() + ":";
				s += (10 > d.getSeconds() ? "0" : "") + d.getSeconds() + "\u00A0";
				s += d.getHours() >= 12 ? "pm" : "am";
				textNode.data = s;
                
                //countdown1 code
                var d_countdown1_targetDay = 0; // Sunday
                var d_countdown1_countdowntime = "9:00:00 AM";
                
                if (d_countdown1_datetime !== null)
                {
                    d_countdown1_targetDay = d_countdown1_datetime.getDay();
                    d_countdown1_countdowntime = "";
				    d_countdown1_countdowntime += ((d_countdown1_datetime.getHours() + 11) % 12 + 1) + ":";
				    d_countdown1_countdowntime += (10 > d_countdown1_datetime.getMinutes() ? "0" : "") + d_countdown1_datetime.getMinutes() + ":";
				    d_countdown1_countdowntime += (10 > d_countdown1_datetime.getSeconds() ? "0" : "") + d_countdown1_datetime.getSeconds() + " ";
				    d_countdown1_countdowntime += d_countdown1_datetime.getHours() >= 12 ? "PM" : "AM";
                }
                
                var d_countdown1_publishMillis = (1000 * 60) * d_countdown1_publishMinutes; // the publish time but in milliseconds                
                var d_countdown1_expireMillis = (1000 * 60) * d_countdown1_expireMinutes; // the expiration but in milliseconds
                
                var d_countdown1_currentDay = d.getDay();
                var d_countdown1_daysLeft = 0;
                if (d_countdown1_currentDay > d_countdown1_targetDay) // if we missed the target day, figure out how many days until the next one
                {
                    d_countdown1_daysLeft = (7 - d_countdown1_currentDay) + d_countdown1_targetDay;
                }
                else if (d_countdown1_currentDay < d_countdown1_targetDay)
                {
                    d_countdown1_daysLeft = d_countdown1_targetDay - d_countdown1_currentDay;
                }
                
                var d_countdown1_daysLeft_millis = (24 * 60 * 60 * 1000) * d_countdown1_daysLeft;
                var d_countdown1_actualdate = new Date(d.getTime() + d_countdown1_daysLeft_millis);
                
                var d_countdown1_datestring = (d_countdown1_actualdate.getMonth()+1) + "/" + d_countdown1_actualdate.getDate() + "/" + d_countdown1_actualdate.getFullYear() + " " + d_countdown1_countdowntime;
                var d_countdown1_countdowndateObj = new Date(d_countdown1_datestring);
                                
                // Find the distance between now and the count down date
                var d_countdown1_distance = d_countdown1_countdowndateObj - d;

                // Time calculations for days, hours, minutes and seconds
                var d_countdown1_days = Math.floor(d_countdown1_distance / (1000 * 60 * 60 * 24));
                var d_countdown1_hours = Math.floor((d_countdown1_distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var d_countdown1_minutes = Math.floor((d_countdown1_distance % (1000 * 60 * 60)) / (1000 * 60));
                var d_countdown1_seconds = Math.floor((d_countdown1_distance % (1000 * 60)) / 1000);
                
                var d_countdown1_displaystring = (d_countdown1_days > 0 ? d_countdown1_days + "d&nbsp;" : "") + (10 > d_countdown1_hours ? "0" : "") + d_countdown1_hours + ":" + (10 > d_countdown1_minutes ? "0" : "") + d_countdown1_minutes + ":" + (10 > d_countdown1_seconds ? "0" : "") + d_countdown1_seconds + "";

                //countdown2 code
                var d_countdown2_targetDay = 0; // Sunday
                var d_countdown2_countdowntime = "11:00:00 AM";
                
                if (d_countdown2_datetime !== null)
                {
                    d_countdown2_targetDay = d_countdown2_datetime.getDay();
                    d_countdown2_countdowntime = "";
				    d_countdown2_countdowntime += ((d_countdown2_datetime.getHours() + 11) % 12 + 1) + ":";
				    d_countdown2_countdowntime += (10 > d_countdown2_datetime.getMinutes() ? "0" : "") + d_countdown2_datetime.getMinutes() + ":";
				    d_countdown2_countdowntime += (10 > d_countdown2_datetime.getSeconds() ? "0" : "") + d_countdown2_datetime.getSeconds() + " ";
				    d_countdown2_countdowntime += d_countdown2_datetime.getHours() >= 12 ? "PM" : "AM";
                }
                
                var d_countdown2_publishMillis = (1000 * 60) * d_countdown2_publishMinutes; // the publish time but in milliseconds                
                var d_countdown2_expireMillis = (1000 * 60) * d_countdown2_expireMinutes; // the expiration but in milliseconds
                
                var d_countdown2_currentDay = d.getDay();
                var d_countdown2_daysLeft = 0;
                if (d_countdown2_currentDay > d_countdown2_targetDay) // if we missed the target day, figure out how many days until the next one
                {
                    d_countdown2_daysLeft = (7 - d_countdown2_currentDay) + d_countdown2_targetDay;
                }
                else if (d_countdown2_currentDay < d_countdown2_targetDay)
                {
                    d_countdown2_daysLeft = d_countdown2_targetDay - d_countdown2_currentDay;
                }
                                
                var d_countdown2_daysLeft_millis = (24 * 60 * 60 * 1000) * d_countdown2_daysLeft;
                var d_countdown2_actualdate = new Date(d.getTime() + d_countdown2_daysLeft_millis);
                
                var d_countdown2_datestring = (d_countdown2_actualdate.getMonth()+1) + "/" + d_countdown2_actualdate.getDate() + "/" + d_countdown2_actualdate.getFullYear() + " " + d_countdown2_countdowntime;
                var d_countdown2_countdowndateObj= new Date(d_countdown2_datestring);
                                
                // Find the distance between now and the count down date
                var d_countdown2_distance = d_countdown2_countdowndateObj - d;

                // Time calculations for days, hours, minutes and seconds
                var d_countdown2_days = Math.floor(d_countdown2_distance / (1000 * 60 * 60 * 24));
                var d_countdown2_hours = Math.floor((d_countdown2_distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var d_countdown2_minutes = Math.floor((d_countdown2_distance % (1000 * 60 * 60)) / (1000 * 60));
                var d_countdown2_seconds = Math.floor((d_countdown2_distance % (1000 * 60)) / 1000);
                
                var d_countdown2_displaystring = (d_countdown2_days > 0 ? d_countdown2_days + "d&nbsp;" : "") + (10 > d_countdown2_hours ? "0" : "") + d_countdown2_hours + ":" + (10 > d_countdown2_minutes ? "0" : "") + d_countdown2_minutes + ":" + (10 > d_countdown2_seconds ? "0" : "") + d_countdown2_seconds + "";

                // Countdown 1 - Display the countdown
                
                if (d_countdown1_distance < d_countdown1_publishMillis)
                {
                    countdown1TextElem.innerHTML = d_countdown1_displaystring;   
                    countdown1TextTimeElem.innerHTML = "Begins at: " + d_countdown1_countdowntime;
                }
                
                if (d_countdown1_distance < d_countdown1_expireMillis) // color it red if within our expire threshold
                {
                    countdown1TextElem.style.color = "#ff0000";
                }
                
                if (d_countdown1_distance < 0)
                {
                    countdown1TextElem.innerHTML = "00:00:00";
                    
                    if (d_countdown1_distance < -30000) // hide the countdown when it's been expired for 30 seconds or more
                    {
                        countdown1TextElem.innerHTML = "";
                        countdown1TextTimeElem.innerHTML = "";
                    }
                }
                
                // Countdown 2 - Display the countdown
                            
                if (d_countdown2_distance < d_countdown2_publishMillis)
                {
                    countdown2TextElem.innerHTML = d_countdown2_displaystring;
                    countdown2TextTimeElem.innerHTML = "Begins at: " + d_countdown2_countdowntime;
                }
                
                if (d_countdown2_distance < d_countdown2_expireMillis) // color it red if within our expire threshold
                {
                    countdown2TextElem.style.color = "#ff0000";
                }
                
                if (d_countdown2_distance < 0)
                {
                    countdown2TextElem.innerHTML = "00:00:00";
                    
                    if (d_countdown2_distance < -30000) // hide the countdown when it's been expired for 30 seconds or more
                    {
                        countdown2TextElem.innerHTML = "";
                        countdown2TextTimeElem.innerHTML = "";
                    }
                }
                
				setTimeout(updateClock, 1000 - d.getTime() % 1000 + 20);
			}
			
			function updateTextSize() {
				for (var i = 0; 3 > i; i++) {  // Iterate for better better convergence
					curFontSize *= targetWidth / (textElem.offsetWidth / textElem.parentNode.offsetWidth);
					textElem.style.fontSize = curFontSize + "pt";
                    countdown1TextElem.style.fontSize = curFontSize-2 + "pt";
                    countdown1TextTimeElem.style.fontSize = curFontSize/3 + "pt";
                    countdown2TextElem.style.fontSize = curFontSize-2 + "pt";
                    countdown2TextTimeElem.style.fontSize = curFontSize/3 + "pt";
				}
			}
			
			updateClock();
			updateTextSize();
			window.addEventListener("resize", updateTextSize);
		</script>
	</body>
</html>
